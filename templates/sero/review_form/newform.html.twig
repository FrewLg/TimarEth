{% extends 'base.html.twig' %}

{% block title %}
	{% trans %}Survey Form{% endtrans %}
{% endblock %}

{% macro displayVersion(questionaire) %}

	<table>
		<tr>
			<td></td>
			<td>
				{{form_widget(questionaire)}}
			</td>
			<td>

				<button type="button" class="btn   btn-danger close  remove-collection-widget btn-lg mt-8">
					<span aria-hidden="true" class="btn   btn-sm  btn-danger">Ã—</span>
				</button>
			</td>
		</tr>
	</table>

{% endmacro %}

{% block body %}
	<div class="container">
		<div class="row">
			<div class="card my-8">
				<div class="card-header" id="headingOne4">
					<h5 class="card-title">
						<i class="flaticon2-layers-1"></i>

						{{ surveyForm.name}}
					</h5>
					<span class="text-muted">
						{% trans %}Build a questionaire form{% endtrans %}
					</span>
				</div>
				<div class="card-body">
					<div class="my-2">
						<div class="modal fade" id="exampleModalSizeDefault" tabindex="-1" role="dialog" aria-labelledby="exampleModalSizeDefault" style="display: none;" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="exampleModalLabel">{% trans %}Add new questionaire section{% endtrans %}</h5>
										<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											<i aria-hidden="true" class="ki ki-close"></i>
										</button>
									</div>
									<div class="modal-body">
										{{form_start(questionSectionform)}}

										{{form_widget(questionSectionform)}}
									</div>

									<div class="modal-footer">
										<button type="button" class="btn btn-light-primary font-weight-bold" data-dismiss="modal">{% trans %}Close{% endtrans %}</button>
										<button class="btn btn-primary font-weight-bold">{% trans %}Save{% endtrans %}</button>
										{{form_end(questionSectionform)}}

									</div>
								</div>
							</div>
						</div>

						{{ form_start(form) }}
						<div class="form-group  row">
							<label class="col-form-label col-3 text-lg-right text-left">{{ form_label(form.checkListGroup) }}
							</label>

							<div class="col-6">

								{{ form_widget(form.checkListGroup) }}

							</div>
							<div class="col-3">
								<button type="button" class="btn btn-light-primary btn-sm   " data-toggle="modal" data-target="#exampleModalSizeDefault">
									<span aria-hidden="true">+</span>
									{% trans %}Questionaire section{% endtrans %}</button>
							</div>
						</div>
						<div class="form-group  row">
							<label class="col-form-label col-3 text-lg-right text-left">{{ form_label(form.name) }}
							</label>
							<div class="col-8">
								{{ form_widget(form.name) }}
							</div>
						</div>
						<div class="form-group  row">
							<label class="col-form-label col-3 text-lg-right text-left">{{ form_label(form.parent) }}
							</label>
							<div class="col-8">
								{{ form_widget(form.parent) }}
							</div>
						</div>
						<div class="form-group  container">
							<div class="row">

								<div class="col-12 ">
									<div class="form-group">
										<p class="font-weight-bold">{% trans %}Answer Type{% endtrans %}:</p>
										<div class="row">


											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" onclick="javascript:textFunction();" id="yesCheck" name="answer_type" value="3">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">TextArea feedback</span>
														</span>
														<span class="option-body">A user can give an answer using his own words in a texarea
														</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" onclick="javascript:textFunction();" id="textboxCheck" name="answer_type" value="4">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">TextBox feedback</span>
														</span>
														<span class="option-body">A user can give an answer using his own words in a textbox</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" onclick="javascript:choicesFunction();" id="choiceCheck" name="answer_type" value="1">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">Single choice
															</span>
														</span>
														<span class="option-body">A user can only choose one answer at time</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" onclick="javascript:choicesFunction();" id="choiceCheck" name="answer_type" value="2">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">Multiple choice</span>
														</span>
														<span class="option-body">A user can give a multiple answer with checkbox</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" required onclick="javascript:dateFunction();" id="noCheck" name="answer_type" value="5">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">Date choice</span>
														</span>
														<span class="option-body">A user can answer with date selector</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" required onclick="javascript:dateFunction();" id="noCheck" name="answer_type" value="6">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">Number choice</span>
														</span>
														<span class="option-body">A user can answer with number/ integer in a field</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" required onclick="javascript:dateFunction();" id="noCheck" name="answer_type" value="7">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">File choice</span>
														</span>
														<span class="option-body">A user can answer with file upload/ integer in a field</span>
													</span>
												</label>
											</div>
											<div class="col-lg-3">
												<label class="option option option-plain">
													<span class="option-control">
														<span class="radio">
															<input type="radio" required onclick="javascript:dateFunction();" id="noCheck" name="answer_type" value="8">
															<span></span>
														</span>
													</span>
													<span class="option-label">
														<span class="option-head">
															<span class="option-title">Email select choice</span>
														</span>
														<span class="option-body">A user can enter an email addresses</span>
													</span>
												</label>
											</div>
										</div>
									</div>
								</div>

							</div>

							<div id="ifNo" style="display:none;" class="text-muted">
								<i class="la la-info text-danger"></i>
								User Will enter a text in a text box for this answer type.
							</div>
							
							<div id="dateSection" style="display:none;" class="text-muted mb-4">
								<i class="la la-info text-danger"></i>
								User Will select and/or insert their input  for this answer type.
							</div>
							<div id="ifYes" style="display:none;">

								<div class="container">

									<div class="col-md-8   ">
										<button type="button" required="required" class="btn  add-another-collection-widget   btn-sm btn-light-primary float-center " data-list-selector="#objective-fields-list">
											<span aria-hidden="true">+</span>
											Add choice
										</button>
									</div>
								</div>
								<div class="form-group row">
									<div class="row ">
										<div class="col-6 "></div>
										<div class="col-6 ">
											<ul id="objective-fields-list" class="form-group" data-prototype="{{_self.displayVersion(form.answers.vars.prototype)|e }}" data-widget-tags="{{ '<div class="row "></div>'|e }}" data-widget-counter="{{ form.answers|length }}">
												{% for protocol in form.answers %}
													<div class="col-12 ">
														{{ _self.displayVersion(questionaire) }}
													</div>
												{% endfor %}
											</ul>
										</div>
									</div>
								</div>
							</div>

							<div class="form-group">
								<p class="font-weight-bold">{% trans %}Required?{% endtrans %}:</p>
								<div class="row">
									<div class="col-lg-3">
										<label class="option option option-plain">
											<span class="option-control">
												<span class="radio">
													<input type="radio" name="required" value="0">
													<span></span>
												</span>
											</span>
											<span class="option-label">
												<span class="option-head">
													<span class="option-title">Optional</span>
												</span>
												<span class="option-body">
													.</span>
											</span>
										</label>
									</div>
									<div class="col-lg-3">
										<label class="option option-plain">
											<span class="option-control">
												<span class="radio">
													<input type="radio" name="required" value="1">
													<span></span>
												</span>
											</span>
											<span class="option-label">
												<span class="option-head">
													<span class="option-title">Required
													</span>
												</span>
												<span class="option-body">.</span>
											</span>
										</label>
									</div>
								</div>
							</div>
							<div
								class="modal-footer">
								{# <button type="button" class="btn btn-light-primary font-weight-bold" data-dismiss="modal">{% trans %}Close{% endtrans %}</button> #}
								<button class="btn btn-primary font-weight-bold">{% trans %}Save questionaire{% endtrans %}</button>

							</div>
							{{ form_end(form) }}
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="row ">
			<div class="card   col-12">
				<div class="card-body">
					<div class="example-preview">
						<ul class="nav nav-tabs" id="myTab" role="tablist">
							<li class="nav-item">
								<a class="nav-link active" id="home-tab" data-toggle="tab" href="#home">
									<span class="nav-icon">
										<i class="fa fa-calendar"></i>
									</span>
									<span class="nav-text">{% trans %}Form{% endtrans %}
									</span>
								</a>
							</li>
						</ul>
						<div class="tab-content mt-5" id="myTabContent">
							<div class="tab-pane fade active show" id="home" role="tabpanel" aria-labelledby="home-tab">
								{% for checklist in checklist_group %}
									{% set questions = checklist.checklists  |filter(suvey_checklist =>  (suvey_checklist.surveyForm== surveyForm))|length  %}
									{% if questions >0 %}
										<b style="margin-left:10px">
											<span class="text-success">
												Question PART
												{{ toAlpha(loop.index)}}.
												{{checklist}}</span>
										</b>
										<br>
										<div class="separator separator-dashed separator-border-2"></div>

										<ol style="list-style: none;">
											{% for suvey_checklist in checklist.checklists  |filter(suvey_checklist =>  (suvey_checklist.surveyForm == surveyForm)) %}
												<li>
													<b style="margin-right:5">
														<form method="post" action="{{ path('check_list_delete', {'id': suvey_checklist.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
															{{ loop.index}}.
															{{suvey_checklist.name}}
															<p class="text-muted">
																(
																{% if suvey_checklist.answerType==1 %}Single choice
																	{% elseif suvey_checklist.answerType==2 %}Multiple answer{% elseif suvey_checklist.answerType==3 %}Wide Textarea response
																	{% elseif suvey_checklist.answerType==5 %}Date type
																	{% elseif suvey_checklist.answerType==6 %}Number Choice
																	{% elseif suvey_checklist.answerType==8 %}Email type
																	{% elseif suvey_checklist.answerType==4 %}Text box
																{% endif %})
															</p>
															<ul style="list-style: none;">
																{% for item in suvey_checklist.answers %}
																	<li>{{toAlpha(loop.index)}}.
																		{{item.choiceName}}
																	</li>
																{% endfor %}
															</ul>
														</b>
														{% if suvey_checklist.surveyResponses|length>0 %}
															{% else %}
														<a href="{{ path('survey_form_edit', {'id': suvey_checklist.id}) }}" class="btn btn-light-warning btn-sm">edit</a>

																<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ suvey_checklist.id) }}">
																<button class="btn btn-light-danger btn-sm">Delete</button>
														{% endif %}
													</form>
												</li>
											{% endfor %}
										</ol>
									{% endif %}
								{% endfor %}
							</div>
							<div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">Tab content 3</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
{% block javascripts %}

	<script>

		var x = document.getElementById("ifYes");  
		var d = document.getElementById("dateSection");  
var y = document.getElementById("ifNo");
function choicesFunction() {
if (x.style.display === "none") {
d.style.display = "none";
x.style.display = "block";
y.style.display = "none";
}
}

function dateFunction() {
if (d.style.display === "none") {
d.style.display = "block";
y.style.display = "none";
x.style.display = "none";
}
}

function textFunction() {
if (y.style.display === "none") {
y.style.display = "block";
d.style.display = "none";
x.style.display = "none";
}
}
	</script>
	<script type='text/javascript'>
		jQuery(document).ready(function () {
$(document).on('click', '.remove-collection-widget', function (e) {
$(this).closest('.row').fadeOut().remove();
});
$(document).on('click', '.add-another-collection-widget', function (e) {
var list = jQuery(jQuery(this).attr('data-list-selector'));
var counter = list.data('widget-counter') || list.children().length;
var newWidget = list.attr('data-prototype');
newWidget = newWidget.replace(/__name__/g, counter);
counter++;
list.data('widget-counter', counter);
var newElem = jQuery(list.attr('data-widget-tags')).html(newWidget);
newElem.appendTo(list);
});
});
	</script>
{% endblock %}
